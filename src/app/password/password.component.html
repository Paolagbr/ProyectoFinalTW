<div class="container d-flex justify-content-center align-items-center min-vh-100 py-4 " >
  <div class=" form card shadow-lg p-4 p-md-5 w-100" style="max-width: 500px; background-color: #e6ccfe;">
    <div class="card-body " >
      <h2 class="card-title text-center mb-4" style="color: #6a0dad; font-family: titulo">Cambiar Contraseña</h2>
      <form [formGroup]="formDesbloqueo" (ngSubmit)="desbloquearCuenta()">

        <div class="mb-3">
          <label for="email" class="form-label" style="color: #5d3f6a;">Correo Electrónico</label>
          <input type="email" id="email" formControlName="email" class="form-control" placeholder="Tu correo electrónico"
                 [class.is-invalid]="formDesbloqueo.get('email')?.invalid && formDesbloqueo.get('email')?.touched">
          @if (formDesbloqueo.get('email')?.invalid && formDesbloqueo.get('email')?.touched) {
            <div class="invalid-feedback">
              @if (formDesbloqueo.get('email')?.errors?.['required']) {
                <span>El correo es obligatorio.</span>
              }
              @if (formDesbloqueo.get('email')?.errors?.['email']) {
                <span>Ingresa un correo válido.</span>
              }
            </div>
          }
        </div>

        <div class="mb-3">
          <label for="oldPassword" class="form-label" style="color: #5d3f6a;">Contraseña Anterior</label>
          <input type="password" id="oldPassword" formControlName="oldPassword" class="form-control" placeholder="Contraseña actual"
                 [class.is-invalid]="formDesbloqueo.get('oldPassword')?.invalid && formDesbloqueo.get('oldPassword')?.touched">
          @if (formDesbloqueo.get('oldPassword')?.invalid && formDesbloqueo.get('oldPassword')?.touched) {
            <div class="invalid-feedback">
              @if (formDesbloqueo.get('oldPassword')?.errors?.['required']) {
                <span>La contraseña anterior es obligatoria.</span>
              }
              @if (formDesbloqueo.get('oldPassword')?.errors?.['minlength']) {
                <span>Mínimo 6 caracteres.</span>
              }
              @if (formDesbloqueo.get('oldPassword')?.errors?.['maxlength']) {
                <span>Máximo 12 caracteres.</span>
              }
              @if (formDesbloqueo.get('oldPassword')?.errors?.['pattern']) {
                <span>Debe incluir una mayúscula y un número.</span>
              }
            </div>
          }
        </div>

        <div class="mb-3">
          <label for="newPassword" class="form-label" style="color: #5d3f6a;">Nueva Contraseña</label>
          <input type="password" id="newPassword" formControlName="newPassword" class="form-control" placeholder="Nueva contraseña"
                 [class.is-invalid]="formDesbloqueo.get('newPassword')?.invalid && formDesbloqueo.get('newPassword')?.touched">
          @if (formDesbloqueo.get('newPassword')?.invalid && formDesbloqueo.get('newPassword')?.touched) {
            <div class="invalid-feedback">
              @if (formDesbloqueo.get('newPassword')?.errors?.['required']) {
                <span>La nueva contraseña es obligatoria.</span>
              }
              @if (formDesbloqueo.get('newPassword')?.errors?.['minlength']) {
                <span>Mínimo 6 caracteres.</span>
              }
              @if (formDesbloqueo.get('newPassword')?.errors?.['maxlength']) {
                <span>Máximo 12 caracteres.</span>
              }
              @if (formDesbloqueo.get('newPassword')?.errors?.['pattern']) {
                <span>Debe incluir una mayúscula y un número.</span>
              }
            </div>
          }
        </div>

        <div class="mb-3">
          <label for="passwordRepeted" class="form-label" style="color: #5d3f6a;">Repetir Nueva Contraseña</label>
          <input type="password" id="passwordRepeted" formControlName="passwordRepeted" class="form-control" placeholder="Repite la nueva contraseña"
                 [class.is-invalid]="(formDesbloqueo.get('passwordRepeted')?.invalid && formDesbloqueo.get('passwordRepeted')?.touched) || (formDesbloqueo.errors?.['passwordsMismatch'] && formDesbloqueo.get('passwordRepeted')?.touched)">
          @if (formDesbloqueo.get('passwordRepeted')?.invalid && formDesbloqueo.get('passwordRepeted')?.touched) {
            <div class="invalid-feedback">
              @if (formDesbloqueo.get('passwordRepeted')?.errors?.['required']) {
                <span>Repetir la contraseña es obligatorio.</span>
              }
              @if (formDesbloqueo.get('passwordRepeted')?.errors?.['minlength']) {
                <span>Mínimo 6 caracteres.</span>
              }
              @if (formDesbloqueo.get('passwordRepeted')?.errors?.['maxlength']) {
                <span>Máximo 12 caracteres.</span>
              }
              @if (formDesbloqueo.get('passwordRepeted')?.errors?.['pattern']) {
                <span>Debe incluir una mayúscula y un número.</span>
              }
            </div>
          }
          @if (formDesbloqueo.errors?.['passwordsMismatch'] && formDesbloqueo.get('passwordRepeted')?.touched) {
            <div class="invalid-feedback d-block"> <span>Las contraseñas no coinciden.</span>
            </div>
          }
        </div>

        <div class="d-grid gap-2 mt-4">
          <button type="submit" class="btn btn-primary btn-lg"
                  [disabled]="formDesbloqueo.invalid"
                  style="background-color: #8a2be2; border-color: #8a2be2;">
            Actualizar y Desbloquear
          </button>
        </div>
      </form>
    </div>
  </div>
</div>